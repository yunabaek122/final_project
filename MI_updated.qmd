---
title: "Untitled"
format: html
---

I. Setup
```{python}
#Packages
import pandas as pd 
import os  
import geopandas as gpd 
import pandas as pd
import matplotlib.pyplot as plt
import altair as alt
import json
import numpy as np 
```

```{python}
#Reading in heat data + cooling centers data + ward data 
file_path = "/Users/mithilaiyer/Documents/GitHub/final_project/shp/Heat_Sensitivity_Exposure_Index.shp"
heat_dc = gpd.read_file(file_path)
sample_path = "/Users/mithilaiyer/Documents/GitHub/final_project/shp/Cooling_Centers_-_District_of_Columbia.shp"
cc_dc = gpd.read_file(sample_path)
wards_path = "/Users/mithilaiyer/Documents/GitHub/final_project/shp/Wards_from_2022.shp"
wards_dc = gpd.read_file(wards_path)
```


```{python}
#Initial cooling centers map
cc_dc.plot(marker='o', color = "green", figsize=(10,8), alpha=0.5)
```


```{python}
#Check CRS 
print(cc_dc.crs)
print(heat_dc.crs)
print(wards_dc.crs)
#Reproject cc_dc to the same CRS
cc_dc = cc_dc.to_crs(heat_dc.crs)
#Variable cleaning
heat_dc['HSI'] = heat_dc['HSI'].apply(lambda x: x if str(x).startswith('0') else np.nan)
heat_dc['ASTHMA'] = heat_dc['ASTHMA'].round(1)
```

II. 2 combination graphs
```{python}
#Combination - HEI & CC
fig, ax = plt.subplots(figsize=(10, 8))

heat_dc.plot(column='HEI', ax=ax, legend=True,
             cmap='viridis',  
             linewidth=0.8, edgecolor='0.8', alpha=0.7)

cc_dc.plot(marker='o', color='green', ax=ax, alpha=0.5, markersize=50)
ax.set_title("HEI and Cooling Centers Accessibility", fontsize=16)
plt.show()
```

```{python}
#Combination - Treecover & CC
fig, ax = plt.subplots(figsize=(10, 8))

heat_dc.plot(column='P_TREECOVE', ax=ax, legend=True,
             cmap='Greens',
             linewidth=0.8, edgecolor='0.8', alpha=0.7)

cc_dc.plot(marker='o', color='red', ax=ax, alpha=0.5, markersize=50)
ax.set_title("Tree Cover and Cooling Centers Accessibility", fontsize=16)
plt.show()
```

III. 3 combination graphs
```{python}
#Combination - HSI, Ward, CC
fig, ax = plt.subplots(figsize=(10, 8))

heat_dc.plot(column='HSI', ax=ax, legend=True,
             cmap='coolwarm',
             linewidth=0.8, edgecolor='0.8', alpha=0.7)


cc_dc.plot(marker='o', color='red', ax=ax, alpha=0.5, markersize=50)
wards_dc.plot(edgecolor="black", facecolor="none", ax=ax, linewidth=1)
ax.set_title("HSI and Cooling Centers Accessibility by Ward", fontsize=16)
plt.show()
```
```{python}
#Combination - HEI, Ward, CC
fig, ax = plt.subplots(figsize=(10, 8))

heat_dc.plot(column='HEI', ax=ax, legend=True,
             cmap='viridis',
             linewidth=0.8, edgecolor='0.8', alpha=0.7)


cc_dc.plot(marker='o', color='red', ax=ax, alpha=0.5, markersize=50)
wards_dc.plot(edgecolor="black", facecolor="none", ax=ax, linewidth=1)
ax.set_title("HEI and Cooling Centers Accessibility by Ward", fontsize=16)
plt.show()
```

```{python}
#Combination - Tree cover, Ward, CC
fig, ax = plt.subplots(figsize=(10, 8))

heat_dc.plot(column='P_TREECOVE', ax=ax, legend=True,
             cmap='Greens',
             linewidth=0.8, edgecolor='0.8', alpha=0.7)


cc_dc.plot(marker='o', color='red', ax=ax, alpha=0.5, markersize=50)
wards_dc.plot(edgecolor="black", facecolor="none", ax=ax, linewidth=1)
ax.set_title("Tree cover and Cooling Centers Accessibility by Ward", fontsize=16)
plt.show()

```

```{python}
#Combination - Asthma, Ward, CC
fig, ax = plt.subplots(figsize=(10, 8))

heat_dc.plot(column='ASTHMA', ax=ax, legend=True,
             cmap='inferno',
             linewidth=0.8, edgecolor='0.8', alpha=0.7)


cc_dc.plot(marker='o', color='red', ax=ax, alpha=0.5, markersize=50)
wards_dc.plot(edgecolor="black", facecolor="none", ax=ax, linewidth=1)
ax.set_title("Asthma and Cooling Centers Accessibility by Ward", fontsize=16)
plt.show()
```

IV. Exploring ward labeling

```{python}
#Dummy code for plotting the empty centroids
print(wards_dc.columns)
wards_dc['centroid'] = wards_dc.geometry.centroid

fig, ax = plt.subplots(figsize=(10, 10))
wards_dc.plot(ax=ax, color='none', edgecolor='black')

for idx, row in wards_dc.iterrows():
    centroid_x, centroid_y = row['centroid'].x, row['centroid'].y
    ax.text(centroid_x, centroid_y, str(row['WARD']), fontsize=14, ha='center', color='black', fontweight='bold')
plt.show()
```

```{python}
#HSI with ward numbers 
fig, ax = plt.subplots(figsize=(10, 8))

heat_dc.plot(column='HSI', ax=ax, legend=True,
             cmap='coolwarm',
             linewidth=0.8, edgecolor='0.8', alpha=0.7)

cc_dc.plot(marker='o', color='red', ax=ax, alpha=0.5, markersize=50)
wards_dc.plot(edgecolor="black", facecolor="none", ax=ax, linewidth=1)

wards_dc['centroid'] = wards_dc.geometry.centroid

for idx, row in wards_dc.iterrows():
    centroid_x, centroid_y = row['centroid'].x, row['centroid'].y
    ax.text(centroid_x, centroid_y, str(row['WARD']), fontsize=14, ha='center', color='black', fontweight='bold')

ax.set_title("HSI and Cooling Centers Accessibility by Ward", fontsize=16)
plt.show()
```

```{python}
#HEI with ward numbers 
fig, ax = plt.subplots(figsize=(10, 8))

heat_dc.plot(column='HEI', ax=ax, legend=True,
             cmap='viridis',
             linewidth=0.8, edgecolor='0.8', alpha=0.7)

cc_dc.plot(marker='o', color='red', ax=ax, alpha=0.5, markersize=50)
wards_dc.plot(edgecolor="black", facecolor="none", ax=ax, linewidth=1)

wards_dc['centroid'] = wards_dc.geometry.centroid

for idx, row in wards_dc.iterrows():
    centroid_x, centroid_y = row['centroid'].x, row['centroid'].y
    ax.text(centroid_x, centroid_y, str(row['WARD']), fontsize=14, ha='center', color='black', fontweight='bold')

ax.set_title("HEI and Cooling Centers Accessibility by Ward", fontsize=16)
plt.show()
```

```{python}
#Treecover with ward numbers 
fig, ax = plt.subplots(figsize=(10, 8))

heat_dc.plot(column='P_TREECOVE', ax=ax, legend=True,
             cmap='Greens',
             linewidth=0.8, edgecolor='0.8', alpha=0.7)

cc_dc.plot(marker='o', color='red', ax=ax, alpha=0.5, markersize=50)
wards_dc.plot(edgecolor="black", facecolor="none", ax=ax, linewidth=1)

wards_dc['centroid'] = wards_dc.geometry.centroid

for idx, row in wards_dc.iterrows():
    centroid_x, centroid_y = row['centroid'].x, row['centroid'].y
    ax.text(centroid_x, centroid_y, str(row['WARD']), fontsize=14, ha='center', color='black', fontweight='bold')

ax.set_title("Tree Cover and Cooling Centers Accessibility by Ward", fontsize=16)
plt.show()
```

```{python}
#Asthma with ward numbers 
heat_dc['ASTHMA'] = heat_dc['ASTHMA'].round(1)

fig, ax = plt.subplots(figsize=(10, 8))

heat_dc.plot(column='ASTHMA', ax=ax, legend=True,
             cmap='Reds',
             linewidth=0.8, edgecolor='0.8', alpha=0.7)

cc_dc.plot(marker='o', color='red', ax=ax, alpha=0.5, markersize=50)
wards_dc.plot(edgecolor="black", facecolor="none", ax=ax, linewidth=1)

wards_dc['centroid'] = wards_dc.geometry.centroid

for idx, row in wards_dc.iterrows():
    centroid_x, centroid_y = row['centroid'].x, row['centroid'].y
    ax.text(centroid_x, centroid_y, str(row['WARD']), fontsize=14, ha='center', color='black', fontweight='bold')

ax.set_title("Asthma and Cooling Centers Accessibility by Ward", fontsize=16)
plt.show()
```

